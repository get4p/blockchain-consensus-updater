// Fix contract reentrancy issues
// Reduce gas cost in minting logic
